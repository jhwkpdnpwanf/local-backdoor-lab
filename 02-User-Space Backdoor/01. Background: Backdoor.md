# Background: Backdoor   
본격적인 실습에 들어가기 전, 백도어의 종류와 조건을 간단하게 정리하고 넘어간다.  
이 조건에 맞춰서 다음 실습파일을 정리할 예정이다.  

<br>

### Backdoor
- 공격자랑 연결이 끊긴 뒤에도, 대상 서버가 공격자에게 쉘을 다시 연결할 수 있게 하는 구조이다.
- 백도어란 시스템 내부에 비정상적인 접근 경로를 몰래 심어놓은 것을 말한다.
<br>

### Type of Backdoors
- **User Space 백도어**
   - 운영체제의 사용자 공간에서 실행되는 백도어이다.
   - 대부분 프로세스가 동작하는 공각이며 system call 등을 통해 커널기능을 간접적으로 사용한다.
   - 방식 예시:
     - **Reverse Shell / Bind Shell**
     - **crontab / systemd**: `@rebot` 이나 `.service` 등록으로 지속성을 확보할 수 있다.
     - **LD_PRELOAD Hooking** : 악성 so 파일을 지정해놓고 특정 libc 함수를 가로챌 수 있다.
     - **로그인 훅** : `.bashrc`, `.zshrc`, `/etc/profile` 등등 로그인 관련 파일 수정으로 자동 실행을 걸어둘 수 있다.
     - **파일 은폐** : 잘 확인하지 않는 `/.system/` 과 같은 곳에 위치시켜 두며 위장한다.
<br>

- **Kernel Space 백도어**
   - 운영체제 커널 내부 또는 커널 모듈 영역에서 실행되는 백도어이다.
   - 이 공간에 접근한 백도어는 전체 시스템을 제어하거나 완전은폐에 가까운 백도어도 구현할 수 있다.
   - 방식 예시:
       - **System Call Hooking** : `sys_open`, `sys_read`, `sys_execve` 과 같은 파일을 후킹하여 사용자 파일에 접근, 명령실행, 모니터링, 변조가 가능하다.
       - **파일 / 포트 / 프로세스 은폐** : 파일 시스템을 조작하거나 `ps`, `top` 과 같은 명령어에 안보이게 은폐할 수 있다.
       - **트리거 기반** : 특정 패킷을 수신, 특정 포트 접근, 특정 입력 등으로 트리거를 만든다.
       - **netfilter Hooking** : 패킷 필터링 루틴에 접근해서 특정 트래픽을 트리거로 활용할 수 있다.
       - **LKM(Loadable Kernal Module)** : 커널에 동적으로 삽입 가능한 모듈을 사용해서 후킹하고 은폐한다.

<br>


### Backdoor 조건
- 실행 권한 확보
   - 커널 공간 백도어의 경우에는 root 권한이 필요한데, 이번 정리들에서는 직접적으로 다루지 않을 내용이다.
   - 권한승격 취약점으로 root 권한을 획득했다는 식으로 넘어갈 예정이다. 
- 지속성 확보
  - 만약 재부팅을 하더라도 작동을 해야하기 때문에 지속성을 지녀야한다.
  - systemd 로 자동화를 시켜두거나 crontab 같은 스케줄 관리 도구를 이용하는 방법이 있다.
- 은폐성
   - 프로세스/파일/포트 등에 위장하거나 숨길 수 있다
   - 로그를 삭제하여 기록을 남기지 않는다.
- 통신 경로 확보
   - 방화벽을 우회하며 통신하는 경로가 있어야한다. 
- 탐지 회피
   - 흔적을 최소화하고 보안 프로그램의 탐지도 우회한다.

<br>

### 마무리
User Space 백도어와 Kernel Space 백도어의 차이점도 간단하게 비교해서 적어놨지만  
실습 난이도와 이해도 등을 고려해 User Space 에서 실습만 먼저 다루면서 감을 익힐 것이다.  

양쪽 공간 모두 위 조건을 기반으로 구현할 예정이니 이번 장의 내용들은 다 기억하고 있어야한다.
